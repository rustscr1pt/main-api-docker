version: "3"
services:
  rust-axum-api:
    build: ./ugo-api-axum
    container_name: rust-axum-api
    restart: unless-stopped
    environment:
      - SESSION_DURATION=900
      - DEPLOY_PORT=8000
      - FILE_LOCATION=mysql.txt
      - BOT_TOKEN_LOCATION=bot_token.txt
      - TELEGRAM_API_PORT=8001
    networks:
      - docker-rust-network
  rust-axum-tg:
    build: ./tg-axum
    container_name: rust-axum-tg
    restart: unless-stopped
    environment:
      - SESSION_DURATION=900
      - DEPLOY_PORT=8001
      - FILE_LOCATION=mysql.txt
      - BOT_TOKEN_LOCATION=bot_token.txt
    networks:
      - docker-rust-network
  rust-axum-nginx:
    build: ./nginx
    container_name: rust-axum-nginx
    restart: unless-stopped
    ports:
      - "80:80"
    depends_on:
      - rust-axum-api
      - rust-axum-tg
    networks:
      - docker-rust-network
networks:
  docker-rust-network:
    driver: bridge